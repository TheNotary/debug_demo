<head>

<style>

body {
  background-color: grey;
}

#canvas {
  background-color: #ccc;
}

#page-wrap {
  width: 500px;
  margin: 0 auto;
}

#console {
  margin: 0 auto;
  width: 180px;
}

#about-text {
  display: none;
  max-width: 400px;
}

#game {
  display: none;
  max-width: 400px;
}

#challenge {
  margin-left: auto;
  margin-right: auto;
  width: 20px;
}

progress {
  height: 100px;
  width: 100%;
}

</style>

<script>
// Variables
var available_letters = [ 'a', 's', 'd', 'f', 'j', 'k', 'l', ';' ]
var current_letter

var gameStatus = 'stopped'
var game_timer
var global_v;

function keyboard_func(e) {

  if (gameStatus == 'started' && e.keyCode >= 32 && e.keyCode <= 126) {
    var typed_letter = String.fromCharCode(e.keyCode).toLowerCase()

    if (typed_letter == current_letter) {
      register_a_hit(current_letter, e.keyCode)
      clear_challenge()
      setTimeout(challenge_player, 200)
    }
    else {
      register_a_miss(current_letter, e.keyCode)
    }
  }

}


function start_game() {
  gameStatus = 'started'
  clear_stats()
  reset_game()
  document.getElementById('game').style.display = "block"

  game_timer = setInterval(game_timer_func, 16)

  setTimeout(challenge_player, 200)
}

function challenge_player() {
  var challenge_tag = document.getElementById('challenge')

  current_letter = pick_random_letter()
  challenge_tag.innerHTML = current_letter
}

function clear_challenge() {
  var challenge_tag = document.getElementById('challenge')
  challenge_tag.innerHTML = "&nbsp;"
}


function register_a_miss(current_letter, keyCode) {
  var tag = document.getElementById("misses")
  var misses_count =  parseInt(tag.innerHTML)
  tag.innerHTML = misses_count + 1
}

function register_a_hit(current_letter, keyCode) {
  var tag = document.getElementById("hits")
  var misses_count =  parseInt(tag.innerHTML)
  tag.innerHTML = misses_count + 1
}

function pick_random_letter() {
  var max = available_letters.length - 1
  var min = 0
  var rand = Math.floor(Math.random()*(max-min+1)+min);
  return available_letters[rand]
}

function game_timer_func() {
  var progress_bar = document.getElementById('progress')
  progress_bar.value = progress_bar.value + 1
  if (progress_bar.value >= progress_bar.max) {
    reset_game()
    gameStatus = 'stopped'
    document.getElementById('game').style.display = "none"
  }
  global_v = progress_bar
}

function reset_game() {
  clearInterval(game_timer)
  document.getElementById('progress').value = 0
  clear_challenge()
}

function clear_stats() {
  document.getElementById("hits").innerHTML = 0
  document.getElementById("misses").innerHTML = 0
}


function toggle_about_text() {
  var about_text_tag = document.getElementById("about-text")
  global_v = about_text_tag
  if (about_text_tag.style.display == "") {
    about_text_tag.style.display = "block"
  }
  else {
    about_text_tag.style.display = ""
  }
}

</script>



</head>


<body onkeydown="keyboard_func(event)">

<div id="page-wrap">

  <div id="console">
    <button onclick="start_game()">Start</button>
    <button onclick="toggle_about_text()">About</button>
  </div>
  <div id="about-text">
    Press the start button and a letter will appear on the screen.  Type that letter as fast as you can to make the letter dissapear.  The faster you are, the better your score!  Ghosts will chase mario for as long as a letter is on the screen.
  </div>

  <div id="game">
    <h1 id="challenge">&nbsp;</h1>

    <progress id="progress" value="0" max="1000"></progress>
  </div>

  <div id="stats">
    <div>Coins Left: <span id="coins-left">10</span></div>
    <div>Misses: <span id="misses">0</div>
    <div>Hits: <span id="hits">0</div>
  </div>

  <div id="sprite-controls">
    <div id="debug-int">0</div>
    <button onclick="spawnGhost()">Spawn Ghost</button>
    <button onclick="spawnBlah()">Spawn Blah</button>
    <button onclick="interaction()">interaction</button>

  </div>

  <div>
    <canvas id="canvas" width="500" height="150"></canvas>
  </div>

</div>
</body>

<script src="assets/effects/automobile.js"></script>
<script src="assets/effects/explodable.js"></script>
<script src="assets/effects/jumpable.js"></script>



<script src="assets/enemies.json"></script>
<script src="assets/mario.json"></script>
<script src="assets/coins.json"></script>
<script src="assets/coinbox.json"></script>

<script src="gameLoop.js"></script>
<script src="userInput.js"></script>
<script src="unit.js"></script>
<script src="debugging.js"></script>

<script src="keyboardMemory.js"></script>

<script src="animator.js"></script>
